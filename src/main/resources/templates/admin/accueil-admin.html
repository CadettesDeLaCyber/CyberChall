<!DOCTYPE html>
<html lang="fr" xmlns:th="http://www.thymeleaf.org">

<!-- HEADER -->
<div th:insert="~{fragments/header :: header}"></div>
<style>
.card-module {
	position: relative;
	border: 1px solid #ccc;
	padding: 20px;
	margin: 20px;
	border-radius: 10px;
	transition: box-shadow 0.3s;
}

.card-module:hover {
	box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
}

.sous-module-slider {
	display: flex;
	overflow-x: auto;
	scroll-behavior: smooth;
	gap: 1rem;
	max-width: 600px;
}

.card-module:hover .sous-module-slider {
    transform: translateX(0); /* Slide-in au hover */
}
.card-sous-module {
	min-width: 200px;
	flex-shrink: 0;
	background: #f0f0f0;
	padding: 1rem;
	border-radius: 8px;
	text-align: center;
}

/* Fl√®ches de navigation */
.arrow-button {
	background-color: transparent;
	font-size: 2rem;
	border: none;
	cursor: pointer;
}

.arrow-button:hover {
	opacity: 1;
}

.arrow-left {
	left: 0;
}

.arrow-right {
	right: 0;
}
</style>

<body>
	<!-- NAVIGATION -->
	<div th:insert="~{fragments/nav :: nav}"></div>

	<!-- ‚úÖ Message de bienvenue clair -->
	<div class="accueil-admin">
		<h2 th:if="${admin != null}">
			Bienvenue, <span style="color: #f37500;" th:text="${admin.username}">Admin</span>
			üëã
		</h2>
		<h2 th:if="${admin == null}">Bienvenue invit√© üëã</h2>
	</div>

	<main class="hero">

		<!-- üî∏ Alerte session temporaire -->
		<p th:if="${isSessionMode}" class="text-warning text-center fw-bold">
			‚ö†Ô∏è Vous √™tes dans une session temporaire. Vos donn√©es ne seront pas
			sauvegard√©es.</p>

		<!-- ‚úÖ Affichage des modules -->
		<div class="container mt-4">
    <div class="row">
        <div th:each="module : ${modules}" class="col-md-6 mb-4">
            <div class="card card-module position-relative overflow-hidden" style="height: 250px;">
                <div class="card-body">
                    <h5 class="card-title" th:text="${module.nom}"></h5>

                    <!-- Slider cach√©, affich√© au survol -->
                    <div class="sous-module-slider d-flex position-absolute top-0 start-0 w-100 h-100 bg-white p-3"
                         style="transform: translateX(100%); transition: transform 0.3s ease; z-index: 10; overflow-x: auto; white-space: nowrap;">
                        <div th:each="sm : ${module.sousModules}" class="card me-3" style="min-width: 150px;">
                            <div class="card-body p-2">
                                <p class="card-text" th:text="${sm.titre}"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
		

	</main>

	<script>
    document.querySelectorAll('.arrow-button').forEach(button => {
        button.addEventListener('click', () => {
            const sliderId = button.getAttribute('data-slider-id');
            const slider = document.getElementById('slider-' + sliderId);

            if (!slider) return;

            const direction = button.classList.contains('left') ? -1 : 1;
            const scrollAmount = 220; // largeur approximative d'une card + gap

            slider.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        });
    });
</script>

	<!-- FOOTER -->
	<div th:insert="~{fragments/footer :: footer}"></div>
</body>
</html>